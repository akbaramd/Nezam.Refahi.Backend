// <auto-generated />
using System;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using Nezam.Refahi.Recreation.Infrastructure.Persistence;

#nullable disable

namespace Nezam.Refahi.Recreation.Infrastructure.Migrations
{
    [DbContext(typeof(RecreationDbContext))]
    [Migration("20250927054155_UpdateTheNewChanges")]
    partial class UpdateTheNewChanges
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasDefaultSchema("recreation")
                .HasAnnotation("ProductVersion", "8.0.18")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.ApiIdempotency", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("ClientIp")
                        .HasMaxLength(45)
                        .HasColumnType("nvarchar(45)");

                    b.Property<string>("CorrelationId")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Endpoint")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("IdempotencyKey")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsProcessed")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(false);

                    b.Property<string>("RequestPayloadHash")
                        .HasMaxLength(64)
                        .HasColumnType("nvarchar(64)");

                    b.Property<string>("ResponseData")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("StatusCode")
                        .HasColumnType("int");

                    b.Property<string>("TenantId")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("UserAgent")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("UserId")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.HasKey("Id");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("IX_ApiIdempotency_ExpiresAt");

                    b.HasIndex("UserId")
                        .HasDatabaseName("IX_ApiIdempotency_UserId")
                        .HasFilter("[UserId] IS NOT NULL");

                    b.HasIndex("TenantId", "CreatedAt")
                        .HasDatabaseName("IX_ApiIdempotency_TenantCreatedAt");

                    b.HasIndex("TenantId", "Endpoint", "IdempotencyKey")
                        .IsUnique()
                        .HasDatabaseName("UX_ApiIdempotency_TenantEndpointKey")
                        .HasFilter("[TenantId] IS NOT NULL");

                    b.HasIndex("TenantId", "IsProcessed", "CreatedAt")
                        .HasDatabaseName("IX_ApiIdempotency_TenantProcessedCreated");

                    b.ToTable("ApiIdempotency", "recreation", t =>
                        {
                            t.HasCheckConstraint("CK_ApiIdempotency_ExpiresAfterCreated", "[ExpiresAt] > [CreatedAt]");

                            t.HasCheckConstraint("CK_ApiIdempotency_StatusCodeValid", "[StatusCode] >= 100 AND [StatusCode] <= 599");
                        });
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Feature", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<Guid?>("CategoryId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("DefaultValue")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<int>("DisplayOrder")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(0);

                    b.Property<string>("IconClass")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(true);

                    b.Property<bool>("IsRequired")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(false);

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<byte[]>("RowVersion")
                        .IsRequired()
                        .HasColumnType("varbinary(max)");

                    b.Property<string>("ValidationRules")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<long>("Version")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("CategoryId");

                    b.HasIndex("DisplayOrder");

                    b.HasIndex("IsActive");

                    b.HasIndex("CategoryId", "Name")
                        .IsUnique()
                        .HasFilter("[CategoryId] IS NOT NULL");

                    b.ToTable("Features", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.FeatureCategory", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("ColorCode")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<int>("DisplayOrder")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(0);

                    b.Property<string>("IconClass")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(true);

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("DisplayOrder");

                    b.HasIndex("IsActive");

                    b.HasIndex("Name")
                        .IsUnique();

                    b.ToTable("FeatureCategories", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Participant", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime>("BirthDate")
                        .HasColumnType("date");

                    b.Property<string>("Email")
                        .HasMaxLength(256)
                        .HasColumnType("nvarchar(256)");

                    b.Property<string>("EmergencyContactName")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("EmergencyContactPhone")
                        .HasMaxLength(15)
                        .HasColumnType("nvarchar(15)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("NationalNumber")
                        .IsRequired()
                        .HasMaxLength(20)
                        .HasColumnType("nvarchar(20)");

                    b.Property<string>("Notes")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<int>("ParticipantType")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(2);

                    b.Property<DateTime?>("PaymentDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("PhoneNumber")
                        .IsRequired()
                        .HasMaxLength(15)
                        .HasColumnType("nvarchar(15)");

                    b.Property<DateTime>("RegistrationDate")
                        .HasColumnType("datetime2");

                    b.Property<Guid>("ReservationId")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("NationalNumber")
                        .HasDatabaseName("IX_Participants_NationalNumber");

                    b.HasIndex("ParticipantType")
                        .HasDatabaseName("IX_Participants_ParticipantType");

                    b.HasIndex("RegistrationDate")
                        .HasDatabaseName("IX_Participants_RegistrationDate");

                    b.HasIndex("ReservationId")
                        .HasDatabaseName("IX_Participants_ReservationId");

                    b.HasIndex("ReservationId", "NationalNumber")
                        .IsUnique()
                        .HasDatabaseName("UX_Participants_ReservationNationalNumber");

                    b.ToTable("Participants", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.ReservationPriceSnapshot", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("DiscountCode")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("DiscountDescription")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<int>("ParticipantType")
                        .HasColumnType("int");

                    b.Property<string>("PricingRules")
                        .HasColumnType("nvarchar(max)");

                    b.Property<Guid>("ReservationId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime>("SnapshotDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("TenantId")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.HasKey("Id");

                    b.HasIndex("DiscountCode")
                        .HasDatabaseName("IX_ReservationPriceSnapshots_DiscountCode")
                        .HasFilter("[DiscountCode] IS NOT NULL");

                    b.HasIndex("ReservationId");

                    b.HasIndex("SnapshotDate")
                        .HasDatabaseName("IX_ReservationPriceSnapshots_SnapshotDate");

                    b.HasIndex("TenantId", "ReservationId")
                        .HasDatabaseName("IX_ReservationPriceSnapshots_TenantReservation");

                    b.HasIndex("TenantId", "ReservationId", "ParticipantType")
                        .IsUnique()
                        .HasDatabaseName("UX_ReservationPriceSnapshots_TenantReservationParticipantType")
                        .HasFilter("[TenantId] IS NOT NULL");

                    b.ToTable("ReservationPriceSnapshots", "recreation", t =>
                        {
                            t.HasCheckConstraint("CK_ReservationPriceSnapshots_BasePricePositive", "[BasePriceRials] >= 0");

                            t.HasCheckConstraint("CK_ReservationPriceSnapshots_DiscountValid", "[DiscountAmountRials] IS NULL OR [DiscountAmountRials] >= 0");

                            t.HasCheckConstraint("CK_ReservationPriceSnapshots_FinalPricePositive", "[FinalPriceRials] >= 0");
                        });
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Tour", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime>("CreatedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("datetime2")
                        .HasDefaultValueSql("GETUTCDATE()");

                    b.Property<string>("CreatedBy")
                        .IsRequired()
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("DeletedBy")
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("nvarchar(2000)");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(true);

                    b.Property<bool>("IsDeleted")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(false);

                    b.Property<DateTime?>("LastModifiedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("LastModifiedBy")
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<int?>("MaxAge")
                        .HasColumnType("int");

                    b.Property<int?>("MaxGuestsPerReservation")
                        .HasColumnType("int");

                    b.Property<int?>("MinAge")
                        .HasColumnType("int");

                    b.Property<byte[]>("RowVersion")
                        .IsConcurrencyToken()
                        .IsRequired()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("rowversion");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<DateTime>("TourEnd")
                        .HasColumnType("datetime2");

                    b.Property<DateTime>("TourStart")
                        .HasColumnType("datetime2");

                    b.Property<long>("Version")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt")
                        .HasDatabaseName("IX_Tour_CreatedAt");

                    b.HasIndex("CreatedBy")
                        .HasDatabaseName("IX_Tour_CreatedBy");

                    b.HasIndex("DeletedAt")
                        .HasDatabaseName("IX_Tour_DeletedAt")
                        .HasFilter("[DeletedAt] IS NOT NULL");

                    b.HasIndex("DeletedBy")
                        .HasDatabaseName("IX_Tour_DeletedBy")
                        .HasFilter("[DeletedBy] IS NOT NULL");

                    b.HasIndex("IsActive");

                    b.HasIndex("IsDeleted")
                        .HasDatabaseName("IX_Tour_IsDeleted");

                    b.HasIndex("LastModifiedAt")
                        .HasDatabaseName("IX_Tour_LastModifiedAt")
                        .HasFilter("[LastModifiedAt] IS NOT NULL");

                    b.HasIndex("LastModifiedBy")
                        .HasDatabaseName("IX_Tour_LastModifiedBy")
                        .HasFilter("[LastModifiedBy] IS NOT NULL");

                    b.HasIndex("TourStart");

                    b.HasIndex("TourStart", "TourEnd");

                    b.ToTable("Tours", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourCapacity", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<int>("CapacityState")
                        .HasColumnType("int");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(true);

                    b.Property<int>("MaxParticipants")
                        .HasColumnType("int");

                    b.Property<int>("MaxParticipantsPerReservation")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(10);

                    b.Property<int>("MinParticipantsPerReservation")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(1);

                    b.Property<DateTime>("RegistrationEnd")
                        .HasColumnType("datetime2");

                    b.Property<DateTime>("RegistrationStart")
                        .HasColumnType("datetime2");

                    b.Property<int>("RemainingParticipants")
                        .HasColumnType("int");

                    b.Property<byte[]>("RowVersion")
                        .IsConcurrencyToken()
                        .IsRequired()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("rowversion");

                    b.Property<string>("TenantId")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("RemainingParticipants")
                        .HasDatabaseName("IX_TourCapacity_RemainingParticipants");

                    b.HasIndex("TourId");

                    b.HasIndex("TenantId", "TourId")
                        .HasDatabaseName("IX_TourCapacity_TenantTour");

                    b.HasIndex("TenantId", "RegistrationStart", "RegistrationEnd")
                        .HasDatabaseName("IX_TourCapacity_TenantRegistrationWindow");

                    b.HasIndex("TenantId", "TourId", "IsActive")
                        .HasDatabaseName("IX_TourCapacity_TenantTourActive");

                    b.HasIndex("TenantId", "TourId", "RegistrationStart", "RegistrationEnd")
                        .IsUnique()
                        .HasDatabaseName("UX_TourCapacity_TenantTourPeriod")
                        .HasFilter("[TenantId] IS NOT NULL");

                    b.ToTable("TourCapacities", "recreation", t =>
                        {
                            t.HasCheckConstraint("CK_TourCapacity_MaxParticipants_Positive", "[MaxParticipants] > 0");

                            t.HasCheckConstraint("CK_TourCapacity_ParticipantLimits_Valid", "[MinParticipantsPerReservation] > 0 AND [MaxParticipantsPerReservation] >= [MinParticipantsPerReservation]");

                            t.HasCheckConstraint("CK_TourCapacity_RegistrationDates_Valid", "[RegistrationStart] < [RegistrationEnd]");

                            t.HasCheckConstraint("CK_TourCapacity_RemainingParticipants_Valid", "[RemainingParticipants] >= 0 AND [RemainingParticipants] <= [MaxParticipants]");
                        });
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourFeature", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime>("AssignedAt")
                        .HasColumnType("datetime2");

                    b.Property<Guid>("FeatureId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<bool>("IsHighlighted")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(false);

                    b.Property<string>("Notes")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("AssignedAt");

                    b.HasIndex("FeatureId");

                    b.HasIndex("IsHighlighted");

                    b.HasIndex("TourId");

                    b.HasIndex("TourId", "FeatureId")
                        .IsUnique();

                    b.ToTable("TourFeatures", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourMemberCapability", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("CapabilityId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("CapabilityId")
                        .HasDatabaseName("IX_TourMemberCapabilities_CapabilityId");

                    b.HasIndex("TourId")
                        .HasDatabaseName("IX_TourMemberCapabilities_TourId");

                    b.HasIndex("TourId", "CapabilityId")
                        .IsUnique()
                        .HasDatabaseName("IX_TourMemberCapabilities_TourId_CapabilityId_Unique");

                    b.ToTable("TourMemberCapabilities", "Recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourMemberFeature", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("FeatureId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("FeatureId")
                        .HasDatabaseName("IX_TourMemberFeatures_FeatureId");

                    b.HasIndex("TourId")
                        .HasDatabaseName("IX_TourMemberFeatures_TourId");

                    b.HasIndex("TourId", "FeatureId")
                        .IsUnique()
                        .HasDatabaseName("IX_TourMemberFeatures_TourId_FeatureId_Unique");

                    b.ToTable("TourMemberFeatures", "Recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourPhoto", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("Caption")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<int>("DisplayOrder")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(0);

                    b.Property<string>("FileName")
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("FilePath")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("Url")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("DisplayOrder");

                    b.HasIndex("TourId");

                    b.ToTable("TourPhotos", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourPricing", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<decimal?>("DiscountPercentage")
                        .HasColumnType("decimal(5,2)");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(true);

                    b.Property<int?>("MaxQuantity")
                        .HasColumnType("int");

                    b.Property<int?>("MinQuantity")
                        .HasColumnType("int");

                    b.Property<int>("ParticipantType")
                        .HasColumnType("int");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime?>("ValidFrom")
                        .HasColumnType("date");

                    b.Property<DateTime?>("ValidTo")
                        .HasColumnType("date");

                    b.HasKey("Id");

                    b.HasIndex("IsActive");

                    b.HasIndex("ParticipantType");

                    b.HasIndex("TourId");

                    b.HasIndex("ValidFrom");

                    b.HasIndex("ValidTo");

                    b.HasIndex("TourId", "ParticipantType");

                    b.ToTable("TourPricing", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourReservation", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<Guid?>("BillId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime?>("CancellationDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("CancellationReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<Guid?>("CapacityId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<DateTime?>("ConfirmationDate")
                        .HasColumnType("datetime2");

                    b.Property<DateTime>("CreatedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("datetime2")
                        .HasDefaultValueSql("GETUTCDATE()");

                    b.Property<string>("CreatedBy")
                        .IsRequired()
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("DeletedBy")
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<DateTime?>("ExpiryDate")
                        .HasColumnType("datetime2");

                    b.Property<Guid>("ExternalUserId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<bool>("IsDeleted")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bit")
                        .HasDefaultValue(false);

                    b.Property<DateTime?>("LastModifiedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("LastModifiedBy")
                        .HasMaxLength(100)
                        .IsUnicode(false)
                        .HasColumnType("varchar(100)");

                    b.Property<Guid?>("MemberId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("Notes")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<DateTime>("ReservationDate")
                        .HasColumnType("datetime2");

                    b.Property<byte[]>("RowVersion")
                        .IsConcurrencyToken()
                        .IsRequired()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("rowversion");

                    b.Property<int>("Status")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int")
                        .HasDefaultValue(0);

                    b.Property<string>("TenantId")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<string>("TrackingCode")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<long>("Version")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("CapacityId");

                    b.HasIndex("CreatedAt")
                        .HasDatabaseName("IX_TourReservation_CreatedAt");

                    b.HasIndex("CreatedBy")
                        .HasDatabaseName("IX_TourReservation_CreatedBy");

                    b.HasIndex("DeletedAt")
                        .HasDatabaseName("IX_TourReservation_DeletedAt")
                        .HasFilter("[DeletedAt] IS NOT NULL");

                    b.HasIndex("DeletedBy")
                        .HasDatabaseName("IX_TourReservation_DeletedBy")
                        .HasFilter("[DeletedBy] IS NOT NULL");

                    b.HasIndex("ExpiryDate")
                        .HasDatabaseName("IX_TourReservations_ExpiryDate")
                        .HasFilter("[ExpiryDate] IS NOT NULL");

                    b.HasIndex("IsDeleted")
                        .HasDatabaseName("IX_TourReservation_IsDeleted");

                    b.HasIndex("LastModifiedAt")
                        .HasDatabaseName("IX_TourReservation_LastModifiedAt")
                        .HasFilter("[LastModifiedAt] IS NOT NULL");

                    b.HasIndex("LastModifiedBy")
                        .HasDatabaseName("IX_TourReservation_LastModifiedBy")
                        .HasFilter("[LastModifiedBy] IS NOT NULL");

                    b.HasIndex("ReservationDate")
                        .HasDatabaseName("IX_TourReservations_ReservationDate");

                    b.HasIndex("TourId");

                    b.HasIndex("TenantId", "TrackingCode")
                        .IsUnique()
                        .HasDatabaseName("UX_TourReservations_TenantTrackingCode")
                        .HasFilter("[TenantId] IS NOT NULL");

                    b.HasIndex("TenantId", "CapacityId", "Status")
                        .HasDatabaseName("IX_TourReservations_TenantCapacityStatus");

                    b.HasIndex("TenantId", "ExternalUserId", "ReservationDate")
                        .HasDatabaseName("IX_TourReservations_TenantExternalUserDate");

                    b.HasIndex("TenantId", "MemberId", "ReservationDate")
                        .HasDatabaseName("IX_TourReservations_TenantMemberDate");

                    b.HasIndex("TenantId", "Status", "ExpiryDate")
                        .HasDatabaseName("IX_TourReservations_TenantStatusExpiry");

                    b.HasIndex("TenantId", "TourId", "MemberId")
                        .IsUnique()
                        .HasDatabaseName("UX_TourReservations_TenantTourMember")
                        .HasFilter("[Status] IN (1, 2, 3)");

                    b.HasIndex("TenantId", "TourId", "Status")
                        .HasDatabaseName("IX_TourReservations_TenantTourStatus");

                    b.ToTable("TourReservations", "recreation", t =>
                        {
                            t.HasCheckConstraint("CK_TourReservations_CancellationAfterReservation", "[CancellationDate] IS NULL OR [CancellationDate] >= [ReservationDate]");

                            t.HasCheckConstraint("CK_TourReservations_ConfirmationAfterReservation", "[ConfirmationDate] IS NULL OR [ConfirmationDate] >= [ReservationDate]");

                            t.HasCheckConstraint("CK_TourReservations_ExpiryAfterReservation", "[ExpiryDate] IS NULL OR [ExpiryDate] > [ReservationDate]");
                        });
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourRestrictedTour", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier");

                    b.Property<Guid>("RestrictedTourId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<Guid>("TourId")
                        .HasColumnType("uniqueidentifier");

                    b.Property<Guid?>("TourId1")
                        .HasColumnType("uniqueidentifier");

                    b.HasKey("Id");

                    b.HasIndex("RestrictedTourId")
                        .HasDatabaseName("IX_TourRestrictedTours_RestrictedTourId");

                    b.HasIndex("TourId")
                        .HasDatabaseName("IX_TourRestrictedTours_TourId");

                    b.HasIndex("TourId1");

                    b.HasIndex("TourId", "RestrictedTourId")
                        .IsUnique()
                        .HasDatabaseName("IX_TourRestrictedTours_TourId_RestrictedTourId_Unique");

                    b.ToTable("TourRestrictedTours", "recreation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Feature", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.FeatureCategory", "Category")
                        .WithMany("Features")
                        .HasForeignKey("CategoryId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.Navigation("Category");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Participant", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.TourReservation", "Reservation")
                        .WithMany("Participants")
                        .HasForeignKey("ReservationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "PaidAmount", b1 =>
                        {
                            b1.Property<Guid>("ParticipantId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("PaidAmountRials");

                            b1.HasKey("ParticipantId");

                            b1.ToTable("Participants", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("ParticipantId");
                        });

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "RequiredAmount", b1 =>
                        {
                            b1.Property<Guid>("ParticipantId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("RequiredAmountRials");

                            b1.HasKey("ParticipantId");

                            b1.ToTable("Participants", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("ParticipantId");
                        });

                    b.Navigation("PaidAmount");

                    b.Navigation("RequiredAmount")
                        .IsRequired();

                    b.Navigation("Reservation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.ReservationPriceSnapshot", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.TourReservation", "Reservation")
                        .WithMany("PriceSnapshots")
                        .HasForeignKey("ReservationId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "BasePrice", b1 =>
                        {
                            b1.Property<Guid>("ReservationPriceSnapshotId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("BasePriceRials");

                            b1.HasKey("ReservationPriceSnapshotId");

                            b1.ToTable("ReservationPriceSnapshots", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("ReservationPriceSnapshotId");
                        });

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "DiscountAmount", b1 =>
                        {
                            b1.Property<Guid>("ReservationPriceSnapshotId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("DiscountAmountRials");

                            b1.HasKey("ReservationPriceSnapshotId");

                            b1.ToTable("ReservationPriceSnapshots", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("ReservationPriceSnapshotId");
                        });

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "FinalPrice", b1 =>
                        {
                            b1.Property<Guid>("ReservationPriceSnapshotId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("FinalPriceRials");

                            b1.HasKey("ReservationPriceSnapshotId");

                            b1.ToTable("ReservationPriceSnapshots", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("ReservationPriceSnapshotId");
                        });

                    b.Navigation("BasePrice")
                        .IsRequired();

                    b.Navigation("DiscountAmount");

                    b.Navigation("FinalPrice")
                        .IsRequired();

                    b.Navigation("Reservation");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourCapacity", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("Capacities")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourFeature", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Feature", "Feature")
                        .WithMany("TourFeatures")
                        .HasForeignKey("FeatureId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("TourFeatures")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Feature");

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourMemberCapability", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("MemberCapabilities")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourMemberFeature", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("MemberFeatures")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourPhoto", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("Photos")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourPricing", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("Pricing")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "Price", b1 =>
                        {
                            b1.Property<Guid>("TourPricingId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<decimal>("AmountRials")
                                .HasColumnType("decimal(18,2)")
                                .HasColumnName("PriceRials");

                            b1.HasKey("TourPricingId");

                            b1.ToTable("TourPricing", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("TourPricingId");
                        });

                    b.Navigation("Price")
                        .IsRequired();

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourReservation", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.TourCapacity", "Capacity")
                        .WithMany()
                        .HasForeignKey("CapacityId")
                        .OnDelete(DeleteBehavior.NoAction);

                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany("Reservations")
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "PaidAmount", b1 =>
                        {
                            b1.Property<Guid>("TourReservationId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("PaidAmountRials");

                            b1.HasKey("TourReservationId");

                            b1.ToTable("TourReservations", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("TourReservationId");
                        });

                    b.OwnsOne("Nezam.Refahi.Shared.Domain.ValueObjects.Money", "TotalAmount", b1 =>
                        {
                            b1.Property<Guid>("TourReservationId")
                                .HasColumnType("uniqueidentifier");

                            b1.Property<long>("AmountRials")
                                .HasColumnType("bigint")
                                .HasColumnName("TotalAmountRials");

                            b1.HasKey("TourReservationId");

                            b1.ToTable("TourReservations", "recreation");

                            b1.WithOwner()
                                .HasForeignKey("TourReservationId");
                        });

                    b.Navigation("Capacity");

                    b.Navigation("PaidAmount");

                    b.Navigation("TotalAmount");

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourRestrictedTour", b =>
                {
                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "RestrictedTour")
                        .WithMany()
                        .HasForeignKey("RestrictedTourId")
                        .OnDelete(DeleteBehavior.NoAction)
                        .IsRequired();

                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", "Tour")
                        .WithMany()
                        .HasForeignKey("TourId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Nezam.Refahi.Recreation.Domain.Entities.Tour", null)
                        .WithMany("TourRestrictedTours")
                        .HasForeignKey("TourId1");

                    b.Navigation("RestrictedTour");

                    b.Navigation("Tour");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Feature", b =>
                {
                    b.Navigation("TourFeatures");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.FeatureCategory", b =>
                {
                    b.Navigation("Features");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.Tour", b =>
                {
                    b.Navigation("Capacities");

                    b.Navigation("MemberCapabilities");

                    b.Navigation("MemberFeatures");

                    b.Navigation("Photos");

                    b.Navigation("Pricing");

                    b.Navigation("Reservations");

                    b.Navigation("TourFeatures");

                    b.Navigation("TourRestrictedTours");
                });

            modelBuilder.Entity("Nezam.Refahi.Recreation.Domain.Entities.TourReservation", b =>
                {
                    b.Navigation("Participants");

                    b.Navigation("PriceSnapshots");
                });
#pragma warning restore 612, 618
        }
    }
}
